-- Create users table
CREATE TABLE IF NOT EXISTS users (
  id SERIAL PRIMARY KEY,
  username VARCHAR(255) NOT NULL DEFAULT '',
  pluginlab_id VARCHAR(255) NOT NULL DEFAULT '',
  language VARCHAR(255) NOT NULL DEFAULT 'English'
);

-- Create town records table
CREATE TABLE IF NOT EXISTS town_records (
  id SERIAL PRIMARY KEY,
  coordinates VARCHAR(255) NOT NULL,
  user_id INT NOT NULL,
  content TEXT NOT NULL,
  created_at TIMESTAMP DEFAULT NOW()
)

-- Create world records table
CREATE TABLE IF NOT EXISTS world_records (
  id SERIAL PRIMARY KEY,
  town_record_id INT NOT NULL,
  created_at TIMESTAMP DEFAULT NOW(),
);

-- Create location_status table
CREATE TABLE IF NOT EXISTS location_status (
    location_id SERIAL PRIMARY KEY,
    coordinates VARCHAR(255) NOT NULL UNIQUE,
    occupied BOOLEAN NOT NULL DEFAULT FALSE,
    occupied_by INT,  -- user_id of the player occupying the location
    occupied_since TIMESTAMP
);

-- Create referrals table
CREATE TABLE referrals (
  id SERIAL PRIMARY KEY,
  referrer_id INT NOT NULL,
  referred_id INT NOT NULL,
  referral_date TIMESTAMP DEFAULT NOW(),
  FOREIGN KEY (referrer_id) REFERENCES users(id),
  FOREIGN KEY (referred_id) REFERENCES users(id)
);

-- Create user_referral_count table
CREATE TABLE user_referral_count (
  user_id INT PRIMARY KEY,
  referral_count INT DEFAULT 0,
  FOREIGN KEY (user_id) REFERENCES users(id)
);

-- alter table
ALTER TABLE users
ADD COLUMN first_name VARCHAR(255) NOT NULL DEFAULT '',
ADD COLUMN last_name VARCHAR(255) NOT NULL DEFAULT '';